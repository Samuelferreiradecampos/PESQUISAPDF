import PyPDF2
import os

def buscar_informacoes(pdf_path, nome, numero_rf):
    informacoes_encontradas = []

    with open(pdf_path, 'rb') as file:
        pdf_reader = PyPDF2.PdfFileReader(file)

        for page_num in range(pdf_reader.numPages):
            page = pdf_reader.getPage(page_num)
            text = page.extract_text()

            # Procurar pelo nome
            if nome in text:
                informacoes_encontradas.append({"Tipo": "Nome", "Valor": nome})
            
            # Procurar pelo número de RF
            if numero_rf in text:
                informacoes_encontradas.append({"Tipo": "Número de RF", "Valor": numero_rf})

    return informacoes_encontradas

if __name__ == "__main__":
    # Caminho do PDF no desktop
    pdf_path_no_desktop = os.path.join(os.path.expanduser('~'), 'Desktop', 'documento.pdf')

    # Informações a serem procuradas
    nome_procurado = "Samuel Ferreira de Campos"
    numero_rf_procurado = "8346178"

    # Exemplo de uso
    resultado_pesquisa = buscar_informacoes(pdf_path_no_desktop, nome_procurado, numero_rf_procurado)

    # Exibir resultados apenas se houver algo para mostrar
    for resultado in resultado_pesquisa:
        print(f"Tipo: {resultado['Tipo']}, Valor: {resultado['Valor']}")
