import PyPDF2
import re
import os

def extrair_nome(pdf_path):
    nomes_encontrados = []

    # Extraindo o nome do arquivo sem a extensão
    nome_arquivo = os.path.splitext(os.path.basename(pdf_path))[0]

    with open(pdf_path, 'rb') as pdf_file:
        pdf_reader = PyPDF2.PdfFileReader(pdf_file)

        for page_num in range(pdf_reader.numPages):
            page = pdf_reader.getPage(page_num)
            text = page.extractText()

            # Usar regex para encontrar o nome do arquivo (removendo a extensão) na pesquisa
            padrao_nome_arquivo = re.compile(re.escape(nome_arquivo), re.IGNORECASE)

            if padrao_nome_arquivo.search(text):
                nomes_encontrados.append(nome_arquivo)

    return nomes_encontrados

if __name__ == "__main__":
    # Caminho do PDF no Desktop
    pdf_path_no_desktop = os.path.join(os.path.expanduser('~'), 'Desktop', 'diario oficial edicao 16.02.pdf')

    # Exemplo de uso
    nomes_encontrados = extrair_nome(pdf_path_no_desktop)

    # Exibir resultados apenas se houver algo para mostrar
    if nomes_encontrados:
        print("Nomes encontrados:")
        for nome in nomes_encontrados:
            print(nome)
    else:
        print("Nenhum resultado encontrado.")
